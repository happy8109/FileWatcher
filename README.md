# 文件自动移动工具

一个基于 .NET Framework 3.5 开发的 Windows 文件监视和自动移动工具。该工具可以监视指定文件夹中的文件，并根据预设的规则（文件类型和文件名格式）自动将符合条件的文件移动到目标文件夹。

## 主要功能

- 实时监视文件夹中的新建文件
- 支持启动时扫描现有文件
- 自动移动符合条件的文件
- 文件名格式验证（18位身份证号码）
- 支持多种文件类型
- 文件被占用时自动重试
- 详细的操作日志

## 系统要求

- Windows 操作系统
- .NET Framework 3.5 或更高版本

## 支持的文件类型

- 文本文件 (.txt)
- 图片文件 (.jpg, .png)
- Word文档 (.doc, .docx)
- PDF文件 (.pdf)

## 使用说明

1. 启动程序后，您需要设置以下内容：
   - 监视文件夹：需要监视的源文件夹路径
   - 目标文件夹：符合条件的文件将被移动到此文件夹
   - 是否扫描现有文件：勾选此选项将在启动监视时处理现有的符合条件的文件

2. 文件名要求：
   - 文件名必须是18位身份证号码格式
   - 最后一位可以是数字或 'X'（不区分大小写）
   - 例如：110101199001011234 或 11010119900101123X

3. 操作步骤：
   - 点击"浏览..."按钮选择监视文件夹和目标文件夹
   - 根据需要选择是否扫描现有文件
   - 点击"开始监视"按钮启动监视
   - 程序将自动处理符合条件的文件
   - 可以通过日志窗口查看处理状态
   - 点击"停止监视"按钮停止监视

4. 日志信息：
   - 显示文件检测、移动、完成等状态
   - 记录错误信息和重试过程
   - 支持清除日志记录

## 注意事项

1. 确保程序对监视文件夹和目标文件夹有足够的访问权限
2. 如果文件被其他程序占用，系统会自动重试（最多10次）
3. 目标文件夹如果不存在会被自动创建
4. 停止监视后才能更改文件夹设置

## 错误处理

- 文件被占用：自动重试，间隔100毫秒
- 文件夹不存在：自动创建目标文件夹
- 权限不足：显示错误信息
- 其他错误：在日志中显示详细错误信息

## 开发说明

该项目使用C#开发，主要包含以下组件：

- `FileWatcher`：负责文件监视和文件名验证
- `FileProcessor`：负责文件处理和队列管理
- `WinFormDemo`：用户界面实现
 